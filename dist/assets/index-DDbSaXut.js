(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function o(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(n){if(n.ep)return;n.ep=!0;const s=o(n);fetch(n.href,s)}})();const g={apiKey:"AIzaSyB-ve_suzb3nULDHJE4G_gkHQcMx97asf8",authDomain:"nilacseruet.github.io",projectId:"quize-44349",storageBucket:"quize-44349.firebasestorage.app",messagingSenderId:"80986581205",appId:"1:80986581205:web:b44731bdefbf15a8959a5c",measurementId:"G-K3XP09NTJ1"};firebase.initializeApp(g);const a=firebase.auth(),y=firebase.firestore();async function f(){try{return(await(await fetch("input/questions.json")).json()).questions}catch(t){throw console.error("Error loading questions:",t),t}}function h(t){const e=document.getElementById("quiz-form"),o=t.map((r,n)=>`
        <div class="question-group" data-question-id="${r.id}">
            <div class="question-text">${n+1}. ${r.text}</div>
            <div class="choices-group">
                ${r.options.map((s,i)=>`
                    <label class="choice-container">
                        <input type="radio" name="${r.id}" value="${i}" required>
                        ${s}
                    </label>
                `).join("")}
            </div>
            <div class="correct-answer-text"></div>
        </div>
    `).join("");document.getElementById("score-banner"),e.innerHTML=o+e.innerHTML.substring(e.innerHTML.indexOf('<div id="score-banner"'))}function b(t,e){e.forEach(o=>{const r=document.querySelector(`[data-question-id="${o.id}"]`),n=t.get(o.id),s=o.correctAnswer.toString();if(r.querySelectorAll(".choice-container").forEach((c,m)=>{const u=c.querySelector('input[type="radio"]');u.value===n?n===s?c.classList.add("correct"):c.classList.add("incorrect"):u.value===s&&c.classList.add("correct"),u.disabled=!0}),n!==s){const c=r.querySelector(".correct-answer-text");c.textContent=`Correct answer: ${o.options[o.correctAnswer]}`,c.style.display="block"}})}function w(t,e){let o=0;return e.forEach(r=>{t.get(r.id)===r.correctAnswer.toString()&&o++}),{score:o,totalQuestions:e.length,percentage:o/e.length*100}}let l=[],p=[];async function E(){try{const e=await(await fetch("input/group.json",{cache:"no-store"})).json();return document.getElementById("quiz_title").innerHTML=e.quiz_title,console.log("Quiz title loaded:",e.quiz_title),e.quiz_title}catch(t){throw console.error("Error loading quiz_title:",t),t}}async function I(){try{return(await(await fetch("input/group.json")).json()).groups}catch(t){throw console.error("Error loading groups:",t),t}}function v(t){const e=document.getElementById("group"),o='<option value="" disabled selected>Select Group *</option>';e.innerHTML=o,t.forEach(r=>{const n=document.createElement("option");n.value=r.value,n.textContent=r.label,e.appendChild(n)})}function z(t){const e=document.getElementById("auth-state");e.style.display="block",t?(e.textContent=`Authenticated (Anonymous User ID: ${t.uid})`,e.style.backgroundColor="#e6ffe6",e.style.color="#006600"):(e.textContent="Not authenticated",e.style.backgroundColor="#ffe6e6",e.style.color="#990000")}function d(t,e){const o=document.getElementById("successMessage"),r=document.getElementById("error");t==="success"?(o.textContent=e,o.style.display="block",r.style.display="none",setTimeout(()=>{o.style.display="none"},3e3)):(r.textContent=e,r.style.display="block",o.style.display="none")}function B(t){const e=`Quiz Score: ${t.score}/${t.totalQuestions} (${t.percentage.toFixed(2)}%)`,o=document.getElementById("top-score-banner");o.textContent=e,o.style.display="block";const r=document.getElementById("bottom-score-banner");r.textContent=e,r.style.display="block"}async function q(t){t.preventDefault();const e=document.getElementById("submit-btn");e.disabled=!0;try{if(!a.currentUser)throw new Error("Please wait for authentication to complete");const o=document.getElementById("name").value.trim(),r=document.getElementById("group").value,n=document.getElementById("quiz_title").textContent;if(!o)throw new Error("Please enter your name");if(!r)throw new Error("Please select your group");const s=new FormData(t.target),i=w(s,l);document.getElementById("marks").value=i.score;const c=i.score,m={Name:o,Group:r,Marks:c,Quiz_title:n,Percentage:parseFloat(i.percentage.toFixed(2)),Timestamp:new Date().toISOString(),UserId:a.currentUser.uid};await y.collection("quiz").add(m),B(i),b(s,l),d("success","Quiz submitted and data saved successfully!"),document.getElementById("name").value="",document.getElementById("group").value="",document.getElementById("marks").value="",e.style.display="none"}catch(o){console.error("Error submitting data:",o),d("error",o.message),e.disabled=!1}}async function S(){try{[l,p]=await Promise.all([f(),I(),E()]),h(l),v(p),a.onAuthStateChanged(e=>{console.log("Auth state changed:",e?"authenticated":"not authenticated"),z(e)}),await a.signInAnonymously(),console.log("Anonymous authentication initiated"),document.getElementById("quiz-form").addEventListener("submit",q)}catch(t){console.error("Error initializing app:",t),d("error",t.message)}}S();
